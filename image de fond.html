home.html

{% extends 'base.html' %}
{% block content %}
{% load review_extras %}
{% load static %}
<div class="container text-center px-5">
  <!-- Début du conteneur avec fond blanc -->
  <div class="white-background"> 
    <div class="row py-4">
      <h2>Mon flux</h2>
    </div>
    <div class="row justify-content-center py-4">
      <a
        class="col-2 btn btn-outline-secondary me-3"
        href="{% url 'create_ticket' %}"
        >Demander une critique</a
      >
      <a
        class="col-2 btn btn-outline-secondary ms-3"
        href="{% url 'create_ticket_and_review' %}"
        >Créer une critique</a
      >
    </div>
    <div id="ticketsAndReviewsContainer">
    {% for item in tickets_and_reviews %}
     {% if item|model_type == 'Ticket' %}
    <div class="row px-5 py-4">
      {% include 'review/partials/ticket_partial.html' with ticket=item %}
    </div>
    {% elif item|model_type == 'Review' %}
    <div class="row px-5 py-4">
      {% include 'review/partials/review_partial.html' with review=item %}
    </div>
    {% endif %}
    {% endfor %}
  </div>
    {% if tickets_and_reviews.has_next %}
    <div class="row justify-content-center py-4">
      <button id="loadMoreBtn" class="col-2 btn btn-outline-secondary me-3">Afficher plus</button>
    </div>
    {% endif %}
  </div> <!-- Fin du conteneur avec fond blanc -->
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const loadMoreBtn = document.getElementById("loadMoreBtn");
    const ticketsAndReviewsContainer = document.getElementById("ticketsAndReviewsContainer");
  
    let page = 1;
  
    loadMoreBtn.addEventListener("click", function() {
      page++;
      const url = `?page=${page}`;
      fetch(url)
        .then(response => response.text())
        .then(data => {
          const parser = new DOMParser();
          const htmlDocument = parser.parseFromString(data, "text/html");
          const newItems = htmlDocument.getElementById("ticketsAndReviewsContainer").innerHTML;
          ticketsAndReviewsContainer.innerHTML += newItems;
          if (!htmlDocument.getElementById("loadMoreBtn")) {
            loadMoreBtn.style.display = "none";
          }
        })
        .catch(error => console.error("Error fetching data:", error));
    });
  });
</script>
{% endblock content %}



base. html


{% load static %}
<html lang="fr" xmlns="http://www.w3.org/1999/html">
    <head>
        <title>LITRevu</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="{% static 'style.css' %}">
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'js/star_ratings.js' %}"></script>
        <link rel="stylesheet" href="{% static 'css/star-ratings.css' %}">
        
        <script type="text/javascript" src="{% static 'js/star-ratings.min.js' %}"></script>

        <title>LITRevue</title>
    </head> 
    <body>
    <div class="container-fluid border border-2 border-dark rounded-4 ml-3 p-0">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="{% url 'home' %}">LITRevu</a>
            {% if user.is_authenticated %}
            <a class="navbar-brand" href="{% url 'upload_profile_photo' %}">
                {% if user.profile_photo %}
                    <img src="{{ user.profile_photo.url }}" alt="ProfilePicture" width="60" class="img-thumbnail d-inline-block align-text-center">
                {% else %}
                    <img src="{% static 'images/default_profile.png' %}" alt="ProfilePicture" width="60" class="img-thumbnail d-inline-block align-text-center">
                {% endif %}
                {{ request.user }}
            </a>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'home' %}">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'post_edit' %}">Mes posts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'follow_users' %}">Abonnements</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'logout' %}">Se déconnecter</a>
                    </li>
                </ul>
            </div>
        </div>
        {% endif %}
    </nav>
    </div>
    <div class="container-fluid border border-2 border-dark rounded-4 ml-3 p-0 background-container">

        {% block content %}{% endblock content %}
    </div>
</div>
    </body>
    </html>

